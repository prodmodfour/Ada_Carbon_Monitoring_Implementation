<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <title>Carbon Usage Heatmap</title>

  <!-- Tailwind (CDN) -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    .tooltip {
      position: absolute;
      pointer-events: none;
      background: white;
      border: 1px solid #e5e7eb;
      border-radius: 0.5rem;
      padding: 0.5rem 0.625rem;
      font-size: 0.875rem;
      box-shadow: 0 10px 20px rgba(0,0,0,0.07), 0 6px 6px rgba(0,0,0,0.05);
      display: none;
      z-index: 10;
    }
  </style>
</head>
<body class="bg-gray-100 min-h-screen p-4 sm:p-6 md:p-8 font-sans">
  <div class="w-full mx-auto bg-white rounded-2xl shadow-lg p-5 sm:p-8">
    <div class="flex flex-col sm:flex-row sm:items-end sm:justify-between gap-4 mb-6">
      <div>
        <h1 class="text-2xl sm:text-3xl font-bold text-gray-800">Carbon Usage Heatmap</h1>
        <p class="text-gray-500">GitHub-style year view · each square is a day</p>
      </div>
      <div class="flex items-center gap-3">
        <label for="year" class="text-sm font-medium text-gray-700">Year</label>
        <input id="year" type="number" class="w-28 p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"
               min="2010" max="2100" value="{{ default_year }}">
        <button id="reload"
                class="px-4 py-2 rounded-xl bg-blue-600 text-white font-medium shadow hover:shadow-md transition">
          Load
        </button>
      </div>
    </div>

    <div class="relative">
      <svg id="heatmap" class="block w-full h-auto"></svg>
      <div id="tooltip" class="tooltip"></div>
    </div>

    <div class="mt-6 flex items-center gap-3 text-sm text-gray-600">
      <span>Lower</span>
      <div class="flex items-center gap-1">
        <span class="inline-block w-4 h-4 rounded" style="background:#22c55e"></span>
        <span class="inline-block w-4 h-4 rounded" style="background:#84cc16"></span>
        <span class="inline-block w-4 h-4 rounded" style="background:#f59e0b"></span>
        <span class="inline-block w-4 h-4 rounded" style="background:#ef4444"></span>
      </div>
      <span>Higher carbon (gCO₂e)</span>
    </div>
  </div>

  <!--
    OPTIONAL CONFIG (no new UI; set entirely in code):
    - Provide your own data by month. Keys can be "January".."December", "Jan".."Dec", or 1..12.
    - Each array is per-day values for that month; missing days default to 0; extra items are ignored.
    - Set MAX_REDNESS to control the color scale's top value. If null/undefined, it auto-uses the data max.
  -->
  <script>
    // Example: replace with your own data. Leave as {} to use server mock data.
    window.CUSTOM_DATA = {
      "January": [],   
      "February": [],
      "March": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,  53076.53772973159, 20160.651740828824, 31692.84847220122, 45850.623162255186, 48678.9899060818, 47982.201854238316, 52860.47379894965, 31101.247564625326, 23856.538350871357, 22466.747073971514, 25144.117162118986, 53157.041019430224],
      "April": [28927.889630419264, 19692.821091557536, 22646.158892184, 9121.603141322132, 18266.39251019613, 26244.92109522511, 48557.9927313331, 51094.60679762949, 41548.04713179593, 36730.992747885655, 31810.43686396447, 25355.462467988524, 20085.86678464851, 23606.627809804944, 37524.87425776822, 17528.635486277693, 36164.12648964196, 21411.179386934953, 14622.569613389185, 27697.37756600029, 30293.4438989438, 34337.72280167098, 43183.68231226492, 40387.70542768693, 38088.607746387526, 33178.82215422092, 20268.24958920068, 34161.276733420935, 40628.15858695624, 42365.67651039458],
      "May": [32288.26360357381, 36350.459855962945, 19859.691992071803, 17825.149680043214, 26111.496885836743, 42553.753339359784, 45540.15967469337, 50013.21297841084, 42661.68145446306, 26851.840922350795, 22058.675326235047, 29240.555683138962, 33779.35357300137, 26274.725332744776, 31551.4815719212, 26621.306228543544, 31369.905558063554, 27221.97006192861, 47756.215725234375, 47606.65005339401, 30965.689321870515, 33567.32297324305, 30226.963734345874, 11963.960276167656, 14732.812191535548, 13750.915077740145, 27585.98138153669, 31999.13402956602, 13419.590637649435, 25984.86922155811, 23445.88546282634],
      "June": [3442.370601881325, 0, 0, 0, 11393.05797464492, 24995.89797150636, 31225.073841478486, 20966.07120547837, 30372.75626284915, 28564.37789907883, 30343.767556322084, 27600.13641335937, 38766.29787809882, 24603.916620682467, 25573.85386253703, 28208.363302194866, 33586.7344573993, 44072.878540615464, 44332.99532815858, 35758.02488412406, 25777.886349935274, 16286.759131759663, 18881.801562833392, 20678.114131833096, 51184.29745102392, 26296.88192235792, 22620.288336459707, 19591.63502305108, 32910.246329853726, 39021.08508808552],
      "July": [62438.34523456068, 50182.5419661636, 14559.475429419215, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9097.09678082016, 20017.867797248844, 17726.155427200625, 21477.700840179317, 16932.239950797444, 17318.021527256948, 34011.64780310112, 35543.66056171941, 29025.0727586269, 28621.1074938628, 36328.90497350168, 51816.999719828644, 45201.00494261186, 36784.483447994615],
      "August": [21678.936379263134, 22508.064322767597, 24570.13171300439, 19013.591478213624, 18418.99499402694, 21955.893737089886, 17570.873557193812, 18699.01197754578, 17646.001086405442, 22308.36922427871, 38369.93324077477, 43553.162748117815, 52906.77984665444, 50624.67023183615, 42757.40823832073, 36310.62835797486, 28463.51612729257, 43777.986374729175, 18607.492824423898, 15102.40025675475, 23717.174826586786, 43042.637369187956, 37072.19197297761, 32800.7495221559, 24097.772414077815, 24167.154406466605, 17584.908302440912, 29031.824142181664, 29714.1554004098, 20411.44789447366, 12605.894213581018],
      "September": [15570.367927397012, 31622.407251066797, 23228.69760977424, 27475.43489796698, 30459.289696218824, 16504.313380707845, 14336.4387673477, 28403.98196664107, 28566.359894872723, 13055.509773324966, 12097.589770938894, 13868.556210564544, 15696.558812023139, 17862.67815822627, 10695.086819524364, 15629.756385935852, 16215.773712529459, 17802.96863321271, 30160.807971472357, 29754.000779826034, 17893.221492332297, 29180.898200993535, 46165.67035468838, 45136.08921733705],
      "October": [],
      "November": [],
      "December": []
    };
    // Controls the color scale. Example: 120000 (gCO2e). Set to null to auto-scale from data.
    window.MAX_REDNESS = 50000;
  </script>

  <script src="{{ url_for('static', filename='app.js') }}"></script>
</body>
</html>
