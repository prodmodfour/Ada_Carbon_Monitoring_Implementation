<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <title>Carbon Usage Heatmap</title>

  <!-- Tailwind (CDN) -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    .tooltip {
      position: absolute;
      pointer-events: none;
      background: white;
      border: 1px solid #e5e7eb;
      border-radius: 0.5rem;
      padding: 0.5rem 0.625rem;
      font-size: 0.875rem;
      box-shadow: 0 10px 20px rgba(0,0,0,0.07), 0 6px 6px rgba(0,0,0,0.05);
      display: none;
      z-index: 10;
    }
  </style>
</head>
<body class="bg-gray-100 min-h-screen p-4 sm:p-6 md:p-8 font-sans">
  <div class="w-full mx-auto bg-white rounded-2xl shadow-lg p-5 sm:p-8">
    <div class="flex flex-col sm:flex-row sm:items-end sm:justify-between gap-4 mb-6">
      <div>
        <h1 class="text-2xl sm:text-3xl font-bold text-gray-800">Carbon Usage Heatmap</h1>
        <p class="text-gray-500">GitHub-style year view · each square is a day</p>
      </div>
      <div class="flex items-center gap-3">
        <label for="year" class="text-sm font-medium text-gray-700">Year</label>
        <input id="year" type="number" class="w-28 p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"
               min="2010" max="2100" value="{{ default_year }}">
        <button id="reload"
                class="px-4 py-2 rounded-xl bg-blue-600 text-white font-medium shadow hover:shadow-md transition">
          Load
        </button>
      </div>
    </div>

    <div class="relative">
      <svg id="heatmap" class="block w-full h-auto"></svg>
      <div id="tooltip" class="tooltip"></div>
    </div>

    <div class="mt-6 flex items-center gap-3 text-sm text-gray-600">
      <span>Lower</span>
      <div class="flex items-center gap-1">
        <span class="inline-block w-4 h-4 rounded" style="background:#22c55e"></span>
        <span class="inline-block w-4 h-4 rounded" style="background:#84cc16"></span>
        <span class="inline-block w-4 h-4 rounded" style="background:#f59e0b"></span>
        <span class="inline-block w-4 h-4 rounded" style="background:#ef4444"></span>
      </div>
      <span>Higher carbon (gCO₂e)</span>
    </div>
  </div>

  <!--
    OPTIONAL CONFIG (no new UI; set entirely in code):
    - Provide your own data by month. Keys can be "January".."December", "Jan".."Dec", or 1..12.
    - Each array is per-day values for that month; missing days default to 0; extra items are ignored.
    - Set MAX_REDNESS to control the color scale's top value. If null/undefined, it auto-uses the data max.
  -->
  <script>
    // Example: replace with your own data. Leave as {} to use server mock data.
    window.CUSTOM_DATA = {
      "January": [],   
      "February": [],
      "March": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,  14333.132935062926, 5115.2971177270465, 9290.398473877509, 12413.459310632514, 11631.520730813749, 13372.34392850155, 17382.66021879124, 10505.035876614285, 7172.196323354716, 6323.382014511923, 7858.808138007402, 15637.00224625984],
      "April": [8060.518894741558, 5615.744909318626, 6414.317985332953, 2496.3302898517127, 4634.200446086604, 6617.47745511981, 12570.153220498252, 10173.835391571585, 5962.556728361994, 6078.872418736395, 6007.889430927254, 4584.823333926302, 3525.0868295972045, 4266.824494486807, 7414.647234109218, 4203.175697081152, 8700.575013611042, 4905.654628922715, 3106.553185909344, 5070.823622850297, 4373.212219983872, 6345.854641780833, 9995.063422371979, 8817.63253109156, 8695.590829306182, 8721.45386498296, 4855.235769506982, 7749.456334418017, 8902.867583397598, 10135.817816729195],
      "May": [7836.498330591823, 10559.304582168737, 5773.184663154071, 4972.428973639871, 7387.39171002295, 12524.993115491798, 12047.578566937047, 14533.83636732076, 13214.348009654821, 7642.07281412579, 6003.52295898933, 7778.579746453833, 9900.87674702955, 7132.445464487917, 8096.969499455665, 6022.667325744087, 6016.089297429339, 6419.9202310615165, 12484.272359157683, 14968.853600535534, 10046.928759241498, 10454.80885023819, 9056.787472494274, 2898.7125009722236, 3461.983922994953, 3130.9335676509027, 8040.446168344962, 9544.473080320084, 3683.413216637048, 6521.622231933039, 6203.943070095581],
      "June": [904.9855429899081, 0, 0, 0, 396.45673268761414, 2056.8283760194245, 3069.5046163980824, 2470.105262755121, 4598.635021861532, 6114.96200105801, 6136.713458016287, 7780.362155771658, 10776.83049353112, 6211.014215833329, 6505.2422529578425, 8811.073225960226, 12455.153570151497, 14918.708558958235, 13180.024597534653, 11018.205814740968, 7130.2963900791165, 4609.989298333253, 6546.7307271861155, 7806.237054611616, 18129.549626560445, 10224.976250788803, 9014.524472592895, 7055.975617507299, 11850.878377506817, 13399.798000268282],
      "July": [19023.94267746664, 18700.979073933388, 5257.051187056604, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 265.663714712439, 552.0485865755332, 482.1649808169295, 558.4330789195245, 1513.6071166654187, 4621.485699820432, 10329.529276859741, 10721.095439348679, 7045.499053605527, 7386.304640549313, 12445.041222347701, 17635.312520571457, 18719.486525783144, 17778.537933595515],
      "August": [8302.694009827497, 7581.248692355464, 7851.592993501074, 5136.312165764199, 5976.7542619903425, 6880.920889658611, 4870.918653422953, 5063.935119127775, 5226.134034624185, 8134.3280471251, 14891.553732376276, 18089.238808295282, 23638.74157964634, 23349.04190654898, 19012.37922849022, 14078.355205698777, 9288.48982866576, 15163.862767445113, 7548.0069594015395, 6403.995083514012, 9731.751475772038, 18415.159812832484, 12212.224722913188, 10864.652180472198, 8609.327495933429, 8979.487641414762, 7775.766553436584, 11789.323012293231, 11068.31125823164, 7987.320916714637, 4746.599303577484],
      "September": [5836.848981475348, 11236.930047043727, 7597.931650683032, 9004.44855929704, 8353.618812296381, 4161.791299006319, 4083.6069447319487, 9560.46576907397, 10028.1543971105, 4105.017454777169, 3873.520405631387, 4484.651940505609, 3941.0762741478297, 3854.5516647766017, 2564.67129050303, 4276.161688370324, 4591.999653048549, 4376.564592671457, 8975.59327740694, 9117.772619683963, 4922.700197000565, 7348.528167586081, 12590.597445813077, 14607.770100785789],
      "October": [],
      "November": [],
      "December": []
    };
    // Controls the color scale. Example: 120000 (gCO2e). Set to null to auto-scale from data.
    window.MAX_REDNESS = 50000;
  </script>

  <script src="{{ url_for('static', filename='app.js') }}"></script>
</body>
</html>
